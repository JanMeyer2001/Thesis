%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%  Introduction %%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Introduction} \label{Ch:Introduction}
Magnetic resonance imaging (MRI) is a commonly used medical imaging technique based on measuring magnetic fields and radio waves~\cite{Brown2014,Serai2021,Singh2023}. Despite its many benefits, the method is weighed down by long acquisition times.
Thus, MRI acquisition is usually accelerated by subsampling the k-space in which the raw MR data is recorded. This, however, leads to problematic image artifacts that hinder further processing. Another problem of the slow data acquisition are motion artifacts which are common for organs like lung and heart~\cite{Chen2022}. These challenges, which are further discussed in the next section, have been traditionally addressed with computationally intensive algorithms. New approaches based on deep neural networks promise to rectify these problems. Neural networks have seen a rise in popularity in recent years in fields such as image processing due to breakthroughs enabled through rapid improvements in computational hardware like graphics processing units (GPUs)~\cite{Chen2020}. While segmentation networks like the \emph{U-Net}~\cite{U-Net} were established quite early with great success, usage of these architectures for registration and even networks for aliasing-free MR reconstruction like~\cite{Kuestner2022,Ghoul2024,Pan2024} have recently come into focus~\cite{Chen2020,Haskins2020}. In this thesis, the possibility of using an unsupervised deep learning approach to align subsampled MRI data as well its potential usage in a motion reconstruction pipeline will be investigated.


\section{Motivation and Challenges of MRI Acquisition} \label{Sec:MotivationChallengesMRIAcquisition}
MRI has a variety of benefits because it is non-invasive, radiation-free and has great contrast for soft tissue. It has a variety of uses including generating high-resolution anatomical and functional images as it is sensitive to many physical properties, like $\text{T}_1$ and $\text{T}_2$ relaxation times, diffusion, and flow. Image contrast can be weighted by these properties through adjusting the scan settings to highlight different anatomical or physiological features~\cite{AdvancesPI}. While it is comparable in many regards to Computed Tomography (CT), it is often favored by physicians due to these reasons~\cite{Liu2013}. However, acquisition speed is its main weakness as a full-body scan can take up to 30 minutes depending on the number of slices scanned~\cite{Brown2014,PulseSequences}. This is a burden on patients due to needing to remain still for a long amount of time in the scanner as well as hindering general efficiency. In emergency situations, for example, CT will generally be used instead of MRI as the radiation is deemed acceptable when in need of quick diagnostic imaging~\cite{Liu2013}. To understand the nuances of this comparison further, the general process of MR acquisition needs to be understood.\\
There are many challenges with MR acquisition due to the nature of the image technology. Firstly, the images are not acquired directly in image space, but the raw data is instead measured in the so-called k-space. This is a Fourier space holding the image frequencies from which the scans can be reconstructed using an inverse Fourier transform (iFT)~\cite{Brown2014}. The frequencies stem from the magnetic resonance of the measured subject. The magnetic excitation and relaxation, however, takes time leading to large total acquisition times as the process needs to be repeated for each line in the k-space to acquire a full-resolution image~\cite{AdvancesPI}. For a spin-echo imaging sequence the acquisition time of $5 \pm 10$ ms for each of the $192 \pm 256$ phase-encoding steps which leads to a total net acquisition time of $1 \pm 2$ s per slice. However, the total acquisition time of the sequence is even longer due to the repetition time defined by e.g. the $\text{T}_1$-contrast~\cite{SamplingStrategies}. Thus, the time needed to
acquire a single image can range from hundreds of milliseconds or less for certain scans (e.g. gradient echo) up to several minutes for others (e.g. spin echo)~\cite{AdvancesPI}.\\
An easy approach for acceleration is to simply measure less lines and fill the missing lines with zeros~\cite{DeepMRIReconstructionSubsampling}. This is usually done for the higher frequencies as these hold information of edges and finer structures in the image, which are deemed less important than the image contrast stored in lower frequencies~\cite{AdvancesPI}. This missing information, however, leads to artifacts upon reconstruction as the Shannon-Nyquist sampling theorem~\cite{Shannon} is violated. Consequently, this kind of acceleration is usually called under- or subsampling of the k-space. The more lines are zeroed out, the worse the artifacts become as more information is missing. This leads to problems for further processing as many algorithms struggle with these artifacts~\cite{DeepMRIReconstructionSubsampling}. \\
Another problem with the long acquisition times is patient movement. While most patient can remain relatively still for up to 30 minutes of measuring, the lung and heart movement cannot simply be stopped. Breath-holds can be imployed~\cite{Zaitsev2015}, however it is hard to exactly reproduce the anatomical positions by breathing in the same amount of air each time~\cite{Lin2022}. Instead, the motion is often estimated and compensated after reconstruction using registration algorithms or networks~\cite{Kuestner2022,Chen2023,GRICS}.

\section{Related Work} \label{Sec:RelatedWork}
Traditionally, mathematical optimization based algorithms like \emph{DARTEL}~\cite{DARTEL}, \emph{Demons} \cite{Vercauteren2009}, \emph{NiftyReg}~\cite{NiftiReg}, \emph{LAP}~\cite{LAP} and \emph{FLASH}~\cite{FLASH} have been used to iteratively solve registration tasks. Most of these use image similarity metrics like the mean squared error (MSE) or mutual information (MI) to judge the alignment of the images~\cite{Fu2020}. Once the similarity has reached an acceptable range, the algorithm stops and the registration is complete. While these algorithm are well-established and based on mathematical theory, they are also very time consuming and computationally expensive~\cite{Chen2023}.\\
A simple way to solve the time problem is to use neural networks to learn the behavior of these algorithms as these are, once trained, fast in execution. Displacements can be generated with the slow mathematical algorithms as ground truth substitutes for the supervised training of networks like \emph{LAPNet}~\cite{LAPNet} and \emph{DeepFlash}~\cite{DeepFlash}. The loss can then be calculated using e.g. the MSE between the displacement generated by the network and the calculated ground truth. Both of these approaches, however, still do not solve the memory problem present as the networks are quite large due to complex values needing to be computed. The performance of these networks might also be limited by the quality of the ground truth displacements which additionally need to be generated for the training~\cite{Chen2020,Zou2022}.\\
Neural networks that can be trained in an unsupervised manner are a logical next step as they do not require ground truth displacements to be trained. Instead they use similarity metrics to compare the images after applying a transformation in order to calculate a loss similar to iterative algorithms. Such networks are \emph{VoxelMorph}~\cite{Voxelmorph}, \emph{IC-Net}~\cite{IC-Net}, \emph{SYM-Net}~\cite{SYM-Net}, \emph{Fourier-Net}~\cite{Fourier-Net} and \emph{Fourier-Net+}~\cite{Fourier-Net+}. The latter use the \emph{SYM-Net} as part of their architecture and are the main networks used in this thesis as they are designed to not only be fast, but also more memory efficient compared to the other neural networks. This is due to only utilizing the real-valued image space and having a decoder without trainable weights, which makes the architecture more lightweight compared to similar networks~\cite{Fourier-Net,Fourier-Net+}.\\
Another important topic is MRI reconstruction where again iterative algorithms are commonly used~\cite{AdvancesPI,CS-MRI,ParallelMRI,GRAPPA}. However, more neural network based approaches have recently come into focus~\cite{DeepMRIReconstructionSubsampling, DeepMRIReconstructionRadialSubsampling}. A important aspect in this regard, as discussed in the previous section, is patient motion. While motion in time-series data can often be corrected after the reconstruction by registration of the individual frames, a growing interest in motion-compensated reconstruction can be observed~\cite{Oksuz2020}. In this process, the reconstruction and motion-correction are not done sequentially, but in one pipeline that optimizes both in a joint process~\cite{Kuestner2022}. Both the reconstruction and the motion-correction aspects of the pipeline can be done by either a traditional algorithm or neural networks. While there are a lot of works that cover this using only iterative algorithms~\cite{GRICS}, recent works have tried to use only neural networks due to time benefits~\cite{Pan2024,Zou2024}.


\section{Contributions and Structure of the Thesis} \label{Sec:ContributionsAndStructure}
As discussed in the previous section, there is a lack of efficient and fast registration methods. Traditional iterative algorithms fail in both regards, while most neural networks struggle with memory efficiency~\cite{Fourier-Net,Fourier-Net+}. Additionally, when tackling highly accelerated data, images have heavy artifacts due to the subsampling applied in the k-space. Most image based approaches struggle to deal with these, however, robust methods like \emph{LAPNet} work directly in k-space~\cite{LAPNet}. This allows for avoiding the reconstruction artifacts, but makes the networks inherently less efficient due to needing to work with complex values which neural networks are not well equipped to handle~\cite{Trabelsi2017}. Besides memory concerns, \emph{LAPNet} is also a supervised approach, meaning that the ground truth displacements need to be calculated with the \emph{LAP} algorithm for all the training data. This, however, has been rectified with the recent introduction of \emph{LAPANet}~\cite{LAPANet}, which is a unsupervised version with attention blocks that works without the need for ground truth displacements.\\
All of these challenges call for an efficient unsupervised neural network that can withstand subsampling artifacts despite working in the image space. For this, we choose to expand the already established work of~\cite{Fourier-Net,Fourier-Net+} as \emph{Fourier-Net} and \emph{Fourier-Net+} are unsupervised neural networks which we will use to efficiently align subsampled MR images. While the network architectures were already tested for e.g. inter-patient brain scan alignment in the literature, a new use-case with undersampled cardiac MR data will be explored. The registration performance will also be compared to both traditional iterative registration algorithms and other neural networks. There, the applicability to this new task will be shown with better results compared to the other methods. Furthermore, a potential use-case in a motion-compensated image reconstruction pipeline will be tested demonstrating the networks potential. Main benefits compared to traditional algorithms are the additionally computation speed and low memory consumption compared to other neural networks while maintaining performance even on highly accelerated data.\\
In chapter~\ref{Ch:Fundamentals}, the foundations of the thesis are introduced, which includes general information about MRI such as basic magnetic principles in section~\ref{SubSec:MagneticExcitationAndRelaxation} image acquisition (section~\ref{SubSec:ImageAcquisitionAndK-Space}), acceleration (section~\ref{SubSec:ImagingAccelerationReconstruction}), and reconstruction (section~\ref{SubSec:Motion-CompensatedReconstruction}). Building on the latter, image transformations (section~\ref{SubSec:ImageTransformations}) and registration (section~\ref{SubSec:ImageRegistration}) are introduced followed by deep learning basics such as common architectures (section~\ref{SubSec:DeepLearningArchitectures}), their use in image registration (section~\ref{SubSec:DLImageRegistration}) and general principles of network training and testing (section~\ref{SubSec:NetworkTrainingAndTesting}).\\
In chapter~\ref{Ch:MasterialsAndMethods}, the materials and methods of the thesis are explained. This includes the specific network architectures in section~\ref{Sec:NetworkArchitecture}, namely \emph{Fourier-Net} (section~\ref{SubSec:Fourier-Net}) and \emph{Fourier-Net+} (section~\ref{SubSec:Fourier-Net+}), followed by the datasets in section~\ref{Sec:Datasets}.
% \emph{CMRxRecon} (section~\ref{Sec:CMRxRecon}) and \emph{ACDC} (section~\ref{Sec:ACDC})
Lastly, the conducted experiments are explained in section~\ref{Sec:Experiments}.\\
In chapter~\ref{Ch:Results} the results for these experiments are presented and discussed in chapter~\ref{Ch:Discussion}. This includes a look at limitations and future work followed by a brief summary and conclusion in chapter~\ref{Ch:Conclusion}.
